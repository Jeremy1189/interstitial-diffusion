function fit = fitness(P, problem)

delta = 10^-4; % The tolerance value for equality constraints

switch problem
    
    case 1
        
        X = P;

        g1 = X(:, 1) + X(:, 2) + X(:, 3) + X(:, 4) + X(:, 5) + X(:, 6) + X(:, 7) + X(:, 8) + X(:, 9) - 175 - delta;
        g2 = 175 - (X(:, 1) + X(:, 2) + X(:, 3) + X(:, 4) + X(:, 5) + X(:, 6) + X(:, 7) + X(:, 8) + X(:, 9)) - delta;

        T1 = 0.6;
        T2 = 1.5;

        g3 = T1 .* X(:, 11) - X(:, 10);
        g4 = X(:, 10) - T2 .* X(:, 11);

        g5 = T1 .* X(:, 12) - X(:, 11);
        g6 = X(:, 11) - T2 .* X(:, 12);

        g7 = T1 .* X(:, 13) - X(:, 12);
        g8 = X(:, 12) - T2 .* X(:, 13);

        g9 = T1 .* X(:, 14) - X(:, 13);
        g10 = X(:, 13) - T2 .* X(:, 14);

        R1 = 10;
        R2 = 30;

        g11 = X(:, 2) - R2 .* abs(X(:, 11) - X(:, 10));
        g12 = R1 .* abs(X(:, 11) - X(:, 10)) - X(:, 2);
        

        g13 = X(:, 4) - R2 .* abs(X(:, 12) - X(:, 11));
        g14 = R1 .* abs(X(:, 12) - X(:, 11)) - X(:, 4);

        g15 = X(:, 6) - R2 .* abs(X(:, 13) - X(:, 12));
        g16 = R1 .* abs(X(:, 13) - X(:, 12)) - X(:, 6);

        g17 = X(:, 8) - R2 .* abs(X(:, 14) - X(:, 13));
        g18 = R1 .* abs(X(:, 14) - X(:, 13)) - X(:, 8);

        g19 = X(:, 1) .* X(:, 10) + 0.5 .* (X(:, 10) + X(:, 11)) .* X(:, 2) +...
            X(:, 3) .* X(:, 11) + 0.5 .* ( X(:, 11) + X(:, 12)) .* X(:, 4) +...
            X(:, 5) .* X(:, 12) + 0.5 .* ( X(:, 12) + X(:, 13)) .* X(:, 6) +...
            X(:, 7) .* X(:, 13) + 0.5 .* ( X(:, 13) + X(:, 14)) .* X(:, 8) +...
            X(:, 9) .* X(:, 14) - 245;
        
        G = [g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13, g14, g15, g16, g17, g18, g19];
        
    case 2
        
        g(:, 1) = + 85.334407 + 0.0056858 * P(:, 2).* P(:, 5) + 0.0006262 * P(:, 1).* P(:, 4) - 0.0022053 * P(:, 3).* P(:, 5) - 92;
        g(:, 2) = -85.334407 - 0.0056858 * P(:, 2).* P(:, 5) - 0.0006262 * P(:, 1).* P(:, 4) + 0.0022053 * P(:, 3).* P(:, 5);
        g(:, 3) = + 80.51249 + 0.0071317 * P(:, 2).* P(:, 5) + 0.0029955 * P(:, 1).* P(:, 2) + 0.0021813 * P(:, 3).^2 - 110;
        g(:, 4) = -80.51249 - 0.0071317 * P(:, 2).* P(:, 5) - 0.0029955 * P(:, 1).* P(:, 2) - 0.0021813 * P(:, 3).^2 + 90;
        g(:, 5) = + 9.300961 + 0.0047026 * P(:, 3).* P(:, 5) + 0.0012547 * P(:, 1).* P(:, 3) + 0.0019085 * P(:, 3) .* P(:, 4) - 25;
        g(:, 6) = -9.300961 - 0.0047026 * P(:, 3).* P(:, 5) - 0.0012547 * P(:, 1).* P(:, 3) - 0.0019085 * P(:, 3) .* P(:, 4) + 20;
        
        G = g;
        
    case 3
        
        g(:, 1) = -127 + 2 * P(:, 1).^2 + 3 * P(:, 2).^4 + P(:, 3) + 4 * P(:, 4).^2 + 5 * P(:, 5);
        g(:, 2) = -282 + 7 * P(:, 1) + 3 * P(:, 2) + 10 * P(:, 3).^2 + P(:, 4) - P(:, 5);
        g(:, 3) = -196 + 23 * P(:, 1) + P(:, 2).^2 + 6 * P(:, 6).^2 - 8 * P(:, 7);
        g(:, 4) = 4 * P(:, 1).^2 + P(:, 2).^2 - 3 * P(:, 1).* P(:, 2) + 2 * P(:, 3).^2 + 5 * P(:, 6) - 11 * P(:, 7);
        
        G = g;
        
    case 4
        
        g(:, 1) = -P(:, 4) + P(:, 3) - 0.55;
        g(:, 2) = -P(:, 3) + P(:, 4) - 0.55;
        g(:, 3) = abs(1000 * sin(-P(:, 3) - 0.25) + 1000 * sin(-P(:, 4) - 0.25) + 894.8 - P(:, 1)) - delta;
        g(:, 4) = abs(1000 * sin(P(:, 3) - 0.25) + 1000 * sin(P(:, 3) - P(:, 4) - 0.25) + 894.8 - P(:, 2)) - delta;
        g(:, 5) = abs(1000 * sin(P(:, 4) - 0.25) + 1000 * sin(P(:, 4) - P(:, 3) - 0.25) + 1294.8) - delta;
        
        G = g;
        
    case 5
        
        g(:, 1) = P(:, 3).^2 + P(:, 4).^2 - 1;
        g(:, 2) = P(:, 9).^2 - 1;
        g(:, 3) = P(:, 5).^2 + P(:, 6).^2 - 1;
        g(:, 4) = P(:, 1).^2 + (P(:, 2) - P(:, 9)).^2 - 1;
        g(:, 5) = (P(:, 1) - P(:, 5)).^2 + (P(:, 2) - P(:, 6)).^2 - 1;
        g(:, 6) = (P(:, 1) - P(:, 7)).^2 + (P(:, 2) - P(:, 8)).^2 - 1;
        g(:, 7) = (P(:, 3) - P(:, 5)).^2 + (P(:, 4) - P(:, 6)).^2 - 1;
        g(:, 8) = (P(:, 3) - P(:, 7)).^2 + (P(:, 4) - P(:, 8)).^2 - 1;
        g(:, 9) = P(:, 7).^2 + (P(:, 8) - P(:, 9)).^2 - 1;
        g(:, 10) = P(:, 2).* P(:, 3) - P(:, 1).* P(:, 4);
        g(:, 11) = -P(:, 3).* P(:, 9);
        g(:, 12) = P(:, 5).* P(:, 9);
        g(:, 13) = P(:, 6).* P(:, 7) - P(:, 5).* P(:, 8);
        
        G = g;
        
    case 6
        
        g(:, 1) = -P(:, 1) + 35 * P(:, 2).^0.6 + 35 * P(:, 3).^0.6;
        g(:, 2) = abs(-300 * P(:, 3) + 7500 * P(:, 5) - 7500 * P(:, 6) - 25 * P(:, 4).* P(:, 5) + 25 * P(:, 4).* P(:, 6) + P(:, 3).* P(:, 4)) - delta;
        g(:, 3) = abs(100 * P(:, 2) + 155.365 * P(:, 4) + 2500 * P(:, 7) - P(:, 2).* P(:, 4) - 25 * P(:, 4).* P(:, 7) - 15536.5) - delta;
        g(:, 4) = abs(-P(:, 5) + log( - P(:, 4) + 900)) - delta;
        g(:, 5) = abs(-P(:, 6) + log(P(:, 4) + 300)) - delta;
        g(:, 6) = abs(-P(:, 7) + log(-2 * P(:, 4) + 700)) - delta;
        
        G = g;
        
    case 7
        
%         g(:, 1) = (P(:, 1) - 2).^2 + (P(:, 2) - 2).^2 - 3;
        g(:, 1) = (P(:, 1) + 2).^2 + (P(:, 2) + 2).^2 - 3;
        g(:, 2) = (P(:, 1) + 4).^2 + (P(:, 2) - 4).^2 - 3;
        g(:, 3) = (P(:, 1) - 4).^2 + (P(:, 2) + 4).^2 - 3;
        
        G = min(g, [], 2);
    case 8
        g1 = P(:, 1) + P(:, 2) + P(:, 3)-1- delta;
        g2 =1-(P(:, 1) + P(:, 2) + P(:, 3)) - delta;
        g3=zeros(length(P(:,1)),1);
%         index_P= find(P(:,1)<1e-2 );
%         g3(index_P)=10.*P(index_P,1);
     
        
%         g3=abs(P(:, 4)-round(P(:, 4)));% not reasonable
%         g4=abs(P(:, 5)-round(P(:, 5)));% not reasonable
%         g5=zeros(length(P(:,4)),1);
%         index_equal=find(abs(P(:,4)-P(:,5))<delta);
%         g5(index_equal)=100;
%         G=[g1,g2,g3,g4,g5];
         G=[g1,g2,g3];
end

index = find(G<=0);
G(index) = 0;
fit = sum(G, 2);
